include:
  - project: 'common/gitlab-ci'
    ref: v0.4.15
    file: '/templates/npm-package.yml'

e2e_test:
  stage: test
  image: registry.kyso.io/docker/node-builder:16.15.1-alpine3.16
  before_script:
    - !reference [.npm-config, before_script]
  services:
    - docker:dind
  script:
    - apk add --no-cache docker-compose
    - cd test 
    - docker-compose down
    - docker-compose build
    - docker-compose up -d
    - cd ..
    - npm install
    - npm run test
    